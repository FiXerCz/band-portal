<%- model_class = Concert -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
  <% if can? :create, Concert %>
    <%= link_to t('.new', :default => t("helpers.links.new")), new_concert_path, :class => 'btn btn-primary' %>
  <% end %>
</div>

<div class="text-center">
    <%= will_paginate @posts, renderer: BootstrapPagination::Rails %>
</div>

<table class="table table-striped concerts">
  <tbody>
  <% @concerts.each do |concert| %>
  <tr><td>
    <div class="event-date">
      <p class="event-month"><%= concert.from_date.strftime("%b %Y") %></p>
      <p class="event-day"><%= concert.from_date.strftime("%e") %></p>
    </div>
    <%= link_to concert.title, concert_path(concert), :class => "concert-title" %><br>
    <strong><%= model_class.human_attribute_name(:where) %></strong>: <%= concert.location %><br>
    <strong><%= model_class.human_attribute_name(:from) %></strong>: <%= concert.from_date.strftime("%e. %B %k:%M") %>, to <%= concert.to_date.strftime("%e. %B %k:%M")  %><br>
    <strong><%= model_class.human_attribute_name(:confirmed_bands) %></strong>:
    <% performer = Performer.where(:concert_id => concert.id, :confirmed => true)
       performer.each_with_index do |p, i| %>
        <% if !i.equal?(performer.length-1)%>
            <%= Band.find(p.band_id).title %>,
        <% else %>
            <%= Band.find(p.band_id).title %>
    <% end
    end %>
    <% if performer.length == 0 %> - <% end %>
    <%= link_to "More information", concert_path(concert), :style => "float: right", :class => "btn-link"%>
    <% if can? :update, concert %>
        <%= link_to t('.edit', :default => t("helpers.links.edit")),
                    edit_concert_path(concert), :class => 'btn btn-default btn-xs', :style => "float: right", 'data-no-turbolink' => true %>
    <% end %>
    <% if can? :destroy, concert %>
        <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                    concert_path(concert), :method => :delete,
                    :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                    :class => 'btn btn-xs btn-danger', :style => "float: right" %><% end %>
  </td></tr>
  <% end %>
  </tbody>
</table>
